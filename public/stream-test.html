<!DOCTYPE html>
<html>
<head>
    <title>Cloudflare Stream ID 测试工具</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .test-item { margin: 15px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        .testing { background: #fff3cd; border-color: #ffeaa7; }
        video { width: 100%; max-width: 400px; height: 225px; background: black; }
        iframe { width: 100%; height: 300px; border: 1px solid #ccc; }
        .url { font-family: monospace; font-size: 12px; word-break: break-all; margin: 5px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎯 Cloudflare Stream ID 测试</h1>
        <p><strong>测试 Stream ID:</strong> <code>f1dcfbd5d645e471579a33a5c9e006dd</code></p>

        <div id="results"></div>

        <div class="test-item">
            <h3>📺 官方 iframe 嵌入测试</h3>
            <iframe
                src="https://iframe.videodelivery.net/f1dcfbd5d645e471579a33a5c9e006dd"
                allow="accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;"
                allowfullscreen="true"
                frameborder="0">
            </iframe>
            <div class="url">URL: https://iframe.videodelivery.net/f1dcfbd5d645e471579a33a5c9e006dd</div>
        </div>
    </div>

    <script>
        const streamId = 'f1dcfbd5d645e471579a33a5c9e006dd';
        const secondStreamId = 'ae2a47c2ac6036543abb2c2c1dbef65a';

        const testUrls = [
            `https://videodelivery.net/${streamId}/manifest/video.m3u8`,
            `https://videodelivery.net/${streamId}/mp4`,
            `https://customer-m033z5x00ks6nunl.cloudflarestream.com/${streamId}/manifest/video.m3u8`,
            `https://videodelivery.net/${streamId}.mp4`,
            `https://videodelivery.net/${streamId}`,
            `https://iframe.videodelivery.net/${streamId}`,
            // 测试第二个ID
            `https://videodelivery.net/${secondStreamId}/manifest/video.m3u8`,
            `https://videodelivery.net/${secondStreamId}/mp4`
        ];

        const resultsDiv = document.getElementById('results');

        async function testUrl(url, index) {
            const testDiv = document.createElement('div');
            testDiv.className = 'test-item testing';
            testDiv.innerHTML = `
                <h3>测试 ${index + 1}: 正在检测...</h3>
                <div class="url">${url}</div>
                <div id="status-${index}">🔄 测试中...</div>
            `;
            resultsDiv.appendChild(testDiv);

            try {
                const response = await fetch(url, { method: 'HEAD' });
                const statusDiv = document.getElementById(`status-${index}`);

                if (response.ok) {
                    testDiv.className = 'test-item success';
                    testDiv.querySelector('h3').textContent = `测试 ${index + 1}: ✅ 成功 (${response.status})`;
                    statusDiv.innerHTML = `✅ HTTP ${response.status} - 可访问<br>Content-Type: ${response.headers.get('content-type') || 'N/A'}`;

                    // 如果是视频文件，尝试播放
                    if (url.includes('.mp4') || url.includes('.m3u8')) {
                        const video = document.createElement('video');
                        video.controls = true;
                        video.src = url;
                        video.style.marginTop = '10px';
                        testDiv.appendChild(video);
                    }
                } else {
                    testDiv.className = 'test-item error';
                    testDiv.querySelector('h3').textContent = `测试 ${index + 1}: ❌ 失败 (${response.status})`;
                    statusDiv.textContent = `❌ HTTP ${response.status} - ${response.statusText}`;
                }
            } catch (error) {
                testDiv.className = 'test-item error';
                testDiv.querySelector('h3').textContent = `测试 ${index + 1}: ❌ 网络错误`;
                document.getElementById(`status-${index}`).textContent = `❌ 错误: ${error.message}`;
            }
        }

        // 依次测试所有URL
        testUrls.forEach((url, index) => {
            setTimeout(() => testUrl(url, index), index * 1000);
        });
    </script>
</body>
</html>